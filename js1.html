<html>
<head>
    <meta charset="utf-8">
    <title>javascript map/set</title>
    <style>
        .content{
            background: red;
            text-align: center;
            border-radius: 5px;
        }
    </style>
</head>
<body>





<!--<div align="center"><img src="http://img.10yan.com/data/attachment/forum/201709/20/224152nu2dlk01exfpfxld.jpg" style="max-width:100%"/></div>&nbsp; &nbsp;&nbsp; &nbsp;7月14日，《魅力中国城》十堰竞演团队与茂名竞演团队在央视同台PK，十堰前两轮投票落后茂名51票，最后一轮反超，最终以1314比1294赢得胜利。这是十堰和茂名的一生一世。&nbsp; &nbsp;&nbsp; &nbsp; 因为PK，我们相互认识，相互熟悉，相互欣赏。我们发现，一个居秦巴山区，一个坐南粤海滨。十堰有大山的坚强，茂名有大海的风情。这是十堰和茂名的山盟海誓。<br />-->
<!--<div align="center"><img src="http://img.10yan.com/data/attachment/forum/201709/20/224039cq999692z29ju1u6.jpg" style="max-width:100%"/></div>&nbsp; &nbsp; 在十堰市旅游委、十堰车务段等部门的支持下，十堰日报传媒集团旗下的湖北当当文化旅游开发有限公司，积极与茂名市相关部门和旅游企业联系对接，经过多次沟通协调，最终确定在9月19日互开旅游专线。十堰和茂名从一生一世到山盟海誓。<br />-->
<!--<div align="center"><img src="http://img.10yan.com/data/attachment/forum/201709/20/230045jzz9nn9h4l4xzs5x.jpg" style="max-width:100%"/></div><br />-->
<!--<div align="left">&nbsp; &nbsp;&nbsp;&nbsp;一起同行的朋友开玩笑说，出去旅游一次，还有这么多人欢送，这么大的场面，旅游生涯中第一次，1999元的价格，19999元未必有的待遇啊。</div><br />-->
<!--<div align="center"><img src="http://img.10yan.com/data/attachment/forum/201709/20/230046bvy7qasbav2wq23v.jpg" style="max-width:100%"/></div><br /><div align="center">专门的VIP绿色通道。</div><br /><div align="center"><img src="http://img.10yan.com/data/attachment/forum/201709/20/230046wtmy88mb8gxmm2y5.jpg" style="max-width:100%"/></div><br /><div align="center">这么大的阵容感觉真的不一样。</div><br /><div align="center"><img src="http://img.10yan.com/data/attachment/forum/201709/20/230046qa6k7t7kghzeqh6p.jpg" style="max-width:100%"/></div><br /><div align="center">提前排队上车。</div><br /><div align="center"><img src="http://img.10yan.com/data/attachment/forum/201709/20/230047rq1l5ve4b5a1545v.jpg" style="max-width:100%"/></div><br /><div align="center">茂名，我们来了！</div><br /><div align="center"><img src="http://img.10yan.com/data/attachment/forum/201709/20/230047d3b3v63eslvsnnsk.jpg" style="max-width:100%"/></div><br /><div align="center"><img src="http://img.10yan.com/data/attachment/forum/201709/20/230146p6zc6c6jbjwaaz09.jpg" style="max-width:100%"/></div><br /><div align="center">下午4点多，列车从十堰出发前往广州。</div><br /><br />-->

<script>

    //变量作用域  这说明JavaScript的函数在查找变量时从自身函数定义开始，
    // 从“内”向“外”查找。
    // 如果内部函数定义了与外部函数重名的变量，
    // 则内部函数的变量将“屏蔽”外部函数的变量。
    // 从函数内部 从内到外 依次查找  如果内部没有定义这个函数 才向外部函数查找
    'use strict';

    //不在任何函数内定义的变量就具有全局作用域
    //实际上，JavaScript默认有一个全局对象window，
    // 全局作用域的变量实际上被绑定到window的一个属性：



    var myapp = {};
    myapp.name = 'myapp';
    myapp.version = 1.0;

    function foo() {

        var x = 1;
        function bar() {
            var x = 'A';
//            alert('x in bar() = ' + x); // 'A'
        }
//        alert('x in foo() = ' + x); // 1
        bar();
    }

    //    m.name = "123";
    //    console.log(m.name);
    myapp.course = 'Learn Javascript';
    //    alert(myapp.course);
    //    alert(window.myapp.course);

</script>

<script>
    'use strict';
    var m = new Map();
    var s = new Set();
    document.write('你的浏览器支持Map set!');

    var m = new Map([['Michael',95],['Bob',75],['Tracy',85]]);
    var s =  m.get('Michael');

    var property_value = Math.SQRT1_2;
    var abs =function(x) {


        if(typeof x !== 'number'){
            throw 'Not a number';
        }
        if(x>=0){
//            alert(arguments[1]);   //arguments 它只在函数内部起作用，并且永远指向当前函数的调用者传入的所有参数
            return x;
        }else{
            return -x;
        }

    };

    abs(5);



    function restt(a, b, ...rest) {

        console.log(rest);
    }




    //测试
    restt(1,2,3,4,5);

</script>


<script>
    //let代替 var 可以申明一个 块级作用域的变量
    'use strict';
    function foo() {
        var sum = 0;
        for (let i =0;i<100;i++){
            sum += i;
        }

        console.log("----- "+sum );
    }
    foo();
</script>

<SCRIPT>
    var xiaoming = {
        name:'小明',
        birth:1990,
        age:function () {
            var y = new Date().getFullYear();
            return y-this.birth;    //this 始终指向当前对象   如果是子函数 也会报错  在一级函数才有效
        }
    };

    xiaoming.age();




</SCRIPT>
<script>

    function getAge() {
        var y = new Date().getFullYear();
        return y - this.birth;
    }

    var ming = {
        name:'小明',
        birth :1998,
        age:getAge
    };

    xiaoming.age();
    //apply   绑定this 变量 第二个参数是array
    getAge.apply(xiaoming,[]);
</script>

<script>
    //apply()把参数打包成Array再传入；

    //call()把参数按顺序传入。
    Math.max.apply(null,[3,5,4]);
    Math.max.call(null,3,4,5);

    var count = 0;
    var oldParseInt = getAge;
    window.getAge = function () {
        count +=1;
        return oldParseInt.apply(null,arguments);
    };
    getAge('10');
    getAge('2');
    getAge('1');


</script>

<script>
    //高阶函数
    function add(x,y,f){
        return f(x) +f(y);

    }

    add(-5,6,Math.abs);

    //map/reduce
    function pow(x){
        return x*x;
    }
    var arr = [1,2,3,4,5,6];
    var arrs = arr.map(pow);
    var arrstr = arr.map(String); //把数组中的 所有内容转换成 字符串类型 number类型 bool

    //reduce() 再看reduce的用法。Array的reduce()把一个函数作用在这个Array的[x1, x2, x3...]上，
    // 这个函数必须接收两个参数，reduce()把结果继续和序列的下一个元素做累积计算，其效果就是：

    //[x1, x2, x3, x4].reduce(f) = f(f(f(x1, x2), x3), x4)


    //filter   把array 某些元素过滤掉 返回剩下的元素
    var filtersarrsy= [1,2,3,4,5];
    var r = filtersarrsy.filter(function (t) { return t%2!==0 });
    console.log(r);

    var rs,ars = ['apple','strawberry','banana','pear','apple','orange','orange','strawberry'];
    r = arr.filter(function (element,index,self) { console.log(self.indexOf(element)); return true;});

    //去除重复字符串
    rs = ars.filter(function (element,index,self) {
        return self.indexOf(element) === index;
    });


    //sort  高阶函数  默认数字 先转换成 字符串 按ascii 排序  sort可以接收一个
    //比较函数来实现自定义排序
    var ars = [10,20,1,2];
    ars.sort(function (x,y) {
        if(x>y){return 1;}else if(x<y){return -1;}else{
            return 0;
        }
    });

</script>

<script>
    //闭包
    function count() {
        var arr = [];
        for (var i=1; i<=3; i++) {
            arr.push(function (n) {
//                console.log(n);
                return function () {
                    return n*n;
                }

            }(i));
//            console.log(i);

        }
        return arr;
    }

    var results = count();
    var f1 = results[0];
    var f2 = results[1];
    var f3 = results[2];

    (function (x) {
        return x*x;
    })(3);   //结果为9;  匿名闭包 并立即执行

    'use strict';
    function create_counter(initial) {
        var x = initial || 0;
        return {
            inc:function () {
                x+=1;
                document.write("<div class=\"content\">xxxx</div><br/>");
                return x;

            }
        }
    }

    var c1 = create_counter();
    c1.inc();
    c1.inc();
    c1.inc();

    var c2 = create_counter();
    c2.inc();
    c2.inc();

    //箭头函数
    var c3 = (x,y)=> x*y;    //如果参数不是一个 就用括号括起来
    c3(2);


    var obj = {
      birth:1990,
      getAge:function () {
          var b = this.birth;
          var fn = () => new Date().getFullYear() - this.birth;
          return fn();
      }
    };

    obj.getAge();

    
</script>
</body>

</html>